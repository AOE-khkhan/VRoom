<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>VRoom</title>

    <!-- Bootstrap -->
    <link href="css/vendor/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <title></title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/vendor/jquery-3.1.0.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/vendor/bootstrap.min.js"></script>

    <link href="css/styles.css" rel="stylesheet">
  </head>
<body>
  <div class="super">
    <div class="container main">
      <div class="home-left row col-md-6 vertical-center-container">
        <form class="lecture" id="teacher-form" action="lecture" method="POST">
          <h1>Start a lecture</h1>
          <input class="input-field" name="room" type="text" placeholder="Room name" >
          <select class="form-control" name="lang" id="teacher-lang"></select>
          <input class="btn btn-success" type="submit" value="Start">
        </form>
      </div>
      <div class="home-right row col-md-6 vertical-center-container">
        <form class="lecture" id="student-form" action="join" method="POST">
          <h1>Join a lecture</h1>
          <input class="input-field" name="room" type="text" placeholder="Room name" >
          <span>Audio Language:</span><select class="form-control" name="audio-lang" id="student-audio-lang"></select>
          <br>
          <span>Subtitle Language:</span><select class="form-control" name="sub-lang" id="student-sub-lang"></select>
          <input class="btn btn-success" type="submit" value="Join">
        </form>
      </div>
    </div>
  </div>
</body>
<script type="text/javascript">
  var languages = localStorage.languages;
  try {
    languages = JSON.parse(languages);
  }
  catch(err) {
    languages = {};
  }

  if (!languages['teacher']) {
    languages['teacher'] = 'en';
  }
  
  if (!languages['student-audio']) {
    languages['student-audio'] = 'en';
  }

  if (!languages['student-sub']) {
    languages['student-sub'] = 'en';
  }

  $.get('/languages', function(data) {
    langs = JSON.parse(data);
    $.each(langs['speech'], function(key, value) {
      if (value['language'] == languages['teacher']) {
        $('#teacher-lang').append('<option value="' + value['language'] + '" selected="selected">' + value['name'] + '</option>')
      }
      else {
        $('#teacher-lang').append('<option value="' + value['language'] + '">' + value['name'] + '</option>')
      }
      if (value['language'] == languages['student-audio']) {
        $('#student-audio-lang').append('<option value="' + value['language'] + '" selected="selected">' + value['name'] + '</option>')
      }
      else {
        $('#student-audio-lang').append('<option value="' + value['language'] + '">' + value['name'] + '</option>')
      }
    });
    $.each(langs['text'], function(key, value) {
      if (key == languages['student-sub']) {
        $('#student-sub-lang').append('<option value="' + key + '" selected="selected">' + value['name'] + '</option>')
      }
      else {
        $('#student-sub-lang').append('<option value="' + key + '">' + value['name'] + '</option>')
      }
    });
  }).fail("error!");

  $('form').on('submit', function() {
    localStorage.languages = JSON.stringify({
      'teacher': $('#teacher-lang').val(),
      'student-audio': $('#student-audio-lang').val(),
      'student-sub': $('#student-sub-lang').val()
    });
  });

</script>
</html>
